{"version":3,"sources":["uni-app:///main.js",null,"webpack:///E:/1MyProject/smi_dome/pages/index/index.vue?37e3","webpack:///E:/1MyProject/smi_dome/pages/index/index.vue?4371","webpack:///E:/1MyProject/smi_dome/pages/index/index.vue?d8eb","uni-app:///pages/index/index.vue","webpack:///E:/1MyProject/smi_dome/pages/index/index.vue?ddec","webpack:///E:/1MyProject/smi_dome/pages/index/index.vue?99e3"],"names":["createPage","Page"],"mappings":";;;;;;;;;;;;;;;;;;;;;;kDAAA;AACA;AACA,4F;AACAA,UAAU,CAACC,cAAD,CAAV,C;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACa;;;AAGjE;AAC+K;AAC/K,gBAAgB,wLAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAipB,CAAgB,sqBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACmCrqB,gD;;;AAGA;AACA,MADA,kBACA;AACA;AACA,oBADA,EACA;AACA,oBAFA,EAEA;AACA,gBAHA;AAIA,kBAJA,EAIA;AACA,wBALA,EAKA;AACA,mBANA,EAMA;AACA,0BAPA,EAOA;AACA,iBARA;AASA,wBATA;;AAWA,GAbA;AAcA;AACA;AACA,yDADA;AAEA,iBAFA,yBAEA,KAFA,EAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KATA,GADA,CAdA;;;AA2BA,QA3BA,kBA2BA,MA3BA,EA2BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,GAzCA;AA0CA,mBA1CA,6BA0CA,GA1CA,EA0CA;AACA;AACA,2BADA;AAEA,+BAFA;AAGA,yCAHA;AAIA,6CAJA;AAKA,6BALA;;AAOA;AACA;AACA;AACA;AACA,mBADA;AAEA,0FAFA;;AAIA,GAzDA;;;;AA6DA;AACA,eADA,yBACA;AACA;AACA,+BADA;;AAGA,KALA;;AAOA,mBAPA,2BAOA,CAPA,EAOA;AACA;AACA;AACA,sBADA;AAEA;AACA;AACA,yCAFA,CAEA;AACA,gEAHA,CAGA;AACA;AACA,mBADA,mBACA,CADA,EACA;AACA;AACA;AACA,iCADA;AAEA,4BAFA;AAGA,8BAHA;;AAKA;AACA,gGADA;AAEA,uBAFA,mBAEA,CAFA,EAEA;AACA;AACA;AACA,iDADA,CACA;AACA;AACA;AACA,wFADA;AAEA,oCAFA;AAGA;AACA,qDADA;AAEA,yDAFA;AAGA,6DAHA;AAIA,kDAJA;AAKA,8CALA;AAMA,iDANA,EAHA;;AAWA,6BAXA,mBAWA,CAXA,EAWA;AACA;AACA;AACA;AACA;AACA,yCADA;AAEA,0CAFA;;AAIA;AACA;AACA;AACA;AACA,6DADA,EACA;AACA,kDAFA,EAEA;AACA,sFAHA,CAGA;AAHA;AAKA;AACA;AACA;AACA,yBAjBA,MAiBA;AACA;AACA,wDADA;AAEA,wCAFA;AAGA,0CAHA;;AAKA;AACA;AACA,uBAtCA;;AAwCA;AACA,iBAhDA;;AAkDA,aA1DA;AA2DA,gBA3DA,gBA2DA,CA3DA,EA2DA;AACA;AACA,aA7DA;;AA+DA,SArEA;AAsEA;AACA;AACA,SAxEA;;AA0EA,KAnFA;;;;;AAwFA;AACA,aAzFA,uBAyFA;AACA;AACA;AACA,eADA,mBACA,GADA,EACA;AACA,gDADA,CACA;AACA;AACA,wBADA;;AAGA,SANA;AAOA,YAPA,gBAOA,GAPA,EAOA;AACA;AACA,2BADA;AAEA,wBAFA;AAGA,0BAHA;;AAKA,SAbA;;AAeA,KA1GA;;AA4GA;AACA,kCA7GA,4CA6GA;AACA;AACA;AACA,eADA,mBACA,GADA,EACA;AACA;AACA;AACA;AACA;AACA,SANA;;AAQA,KAvHA;;AAyHA;AACA,cA1HA,wBA0HA;AACA;AACA;AACA;AACA,iBADA,mBACA,GADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA,8BADA;;AAGA,qCALA,CAKA;AACA;AACA;AACA;;AAEA;AACA;AACA,yCADA;AAEA,gCAFA;AAGA,yBAHA,mBAGA,GAHA,EAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qBANA,MAMA;AACA;AACA,mCADA;AAEA,gDAFA;AAGA,yCAHA;;AAKA;AACA,mBAlBA;AAmBA,sBAnBA,gBAmBA,GAnBA,EAmBA;AACA;AACA;AACA;AACA,mCADA;AAEA,uCAFA;AAGA,yCAHA;;AAKA;AACA,mBA5BA;AA6BA,0BA7BA,sBA6BA;AACA;AACA,mBA/BA;;AAiCA,sBA5CA,CA4CA;AACA;AACA;AACA,WAnDA;;AAqDA,OAtDA,EAsDA,IAtDA;AAuDA;AACA;AACA;AACA,+BADA,CACA;AACA;AACA;AACA,uBADA;AAEA,6BAFA;AAGA,6BAHA;;AAKA;AACA,OAVA,EAUA,KAVA;AAWA,KA/LA;AAgMA;AACA,UAjMA,kBAiMA,MAjMA,EAiMA;AACA;AACA;AACA,OAFA;AAGA;AACA,KAtMA;;AAwMA;AACA,iBAzMA,yBAyMA,GAzMA,EAyMA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BADA,EACA;AACA,iCAFA;AAGA,+CAHA;AAIA,kBAJA;AAKA,eALA,mBAKA,GALA,EAKA;AACA;AACA;AACA,yBADA;AAEA,wBAFA;;AAIA,SAXA;AAYA,YAZA,gBAYA,GAZA,EAYA;AACA;AACA,SAdA;;AAgBA,KAxOA;;AA0OA;AACA,aA3OA,uBA2OA;AACA;AACA;AACA;AACA,8BADA;;AAGA;;AAEA;AACA;AACA,iCADA;AAEA,iBAFA,mBAEA,cAFA,EAEA;AACA;AACA;AACA;AACA;AACA;AACA,mCADA;;;AAIA;AACA;AACA,qCADA;AAEA,uCAFA;AAGA,qBAHA,mBAGA,gBAHA,EAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6BADA,EACA;AACA,yCAFA;AAGA,2CAHA;AAIA,yDAJA;AAKA,yBALA,qBAKA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCADA;AAEA,mGAFA;;AAIA,qBATA;AAUA,mBAnBA;AAoBA,sBApBA,gBAoBA,GApBA,EAoBA;AACA;AACA,mBAtBA;;AAwBA,eAlCA;AAmCA,kBAnCA,gBAmCA,GAnCA,EAmCA;AACA;AACA,eArCA;AAsCA,sBAtCA,oBAsCA,GAtCA,EAsCA;AACA;AACA;AACA,eAzCA;;AA2CA,WAvDA;AAwDA,cAxDA,gBAwDA,GAxDA,EAwDA;AACA;AACA,WA1DA;AA2DA,kBA3DA,oBA2DA,GA3DA,EA2DA;AACA;AACA,WA7DA;;AA+DA,OAtEA,MAsEA;AACA;AACA,yBADA;;AAGA;AACA,KAxTA;;AA0TA;AACA,kBA3TA,4BA2TA;AACA;AACA;AACA,+BADA;AAEA,eAFA,mBAEA,GAFA,EAEA;AACA;AACA;AACA,2BADA;;AAGA,SAPA;;AASA,KAtUA;;AAwUA;AACA,WAzUA,qBAyUA;AACA;AACA,sCADA,EACA;AACA,2BAFA,EAEA;AACA,wDAHA,CAGA;AAHA;AAKA;AACA,KAhVA,EA7DA,E;;;;;;;;;;;;ACtCA;AAAA;AAAA;AAAA;AAAu7B,CAAgB,i7BAAG,EAAC,C;;;;;;;;;;ACA38B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/index/index.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=57280228&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/index.vue\"\nexport default component.exports","export * from \"-!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=template&id=57280228&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"content\">\r\n\r\n\t\t<!-- 已分享 -->\r\n\t\t<view class=\"text-area\" style=\"display: flex;flex-direction: column;\" v-if=\"isFlag\">\r\n\t\t\t<button@click=\"bindGetUserInfo\">点击授权登录</button>\r\n\t\t\t\t<button>已分享</button>\r\n\t\t\t\t<view class=\"\">\r\n\t\t\t\t\t{{userInfo.nickName}}\r\n\t\t\t\t</view>\r\n\t\t\t\t<button type=\"default\" @click=\"onSendB\">发送指令</button>\r\n\t\t</view>\r\n\r\n\r\n\t\t<!-- 未分享 -->\r\n\t\t<view class=\"text-area\" style=\"display: flex;flex-direction: column;\" v-else>\r\n\t\t\t<button@click=\"bindGetUserInfo\">点击授权登录</button>\r\n\t\t\t\t<button open-type=\"share\">分享</button>\r\n\t\t\t\t<view class=\"\">\r\n\t\t\t\t\t服务器接收到的:{{socketMessage.data}}\r\n\t\t\t\t\t{{userInfo.nickName}}\r\n\t\t\t\t</view>\r\n\t\t\t\t<!-- A手动操作控制蓝牙 -->\r\n\t\t\t\t<button class='btn' @click='onConnect'>{{isConnected?'已连接':'连接蓝牙'}}</button>\r\n\t\t\t\t<button class='btn' @click='onGetuuid'>\r\n\t\t\t\t\t{{serviceId&&characteristicId?'已获取设备信息':'获取设备信息'}}\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class='btn' @click='onSendCommand'>发送指令</button>\r\n\t\t\t\t<button class='btn' @click='onCloseConnect'>断开连接</button>\r\n\t\t\t\t        <button @tap=\"startRecord\">录音</button>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tmapState\r\n\t} from 'vuex'\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tidentity: null, // 身份信息\r\n\t\t\t\tuserInfo: null, // 用户信息\r\n\t\t\t\tuserId: '',\r\n\t\t\t\tdeviceId: \"\", //蓝牙设备id,\r\n\t\t\t\tisConnected: false, // 连接状态 默认为false\r\n\t\t\t\tserviceId: \"\", //特征值对应的服务uuid\r\n\t\t\t\tcharacteristicId: \"\", //蓝牙特征值的uuid\r\n\t\t\t\tservice: \"\",\r\n\t\t\t\tcharacteristic: \"\",\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t...mapState({\r\n\t\t\t\tisFlag: (state) => state.isFlag,\r\n\t\t\t\tsocketMessage(state) {\r\n\t\t\t\t\tif(state.socketMessage){\r\n\t\t\t\t\t\tconsole.log(state.socketMessage);\r\n\t\t\t\t\t\tthis.onSendCommand(state.socketMessage);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\treturn state.socketMessage\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tonLoad(option) {\r\n\t\t\t\r\n\t\t\tconsole.log(this.$store.state.isFlag);\r\n\t\t\tif (option.userId) { // 有id则是分享出去了\r\n\t\t\t\tthis.userId = option.userId;\r\n\t\t\t\tthis.$store.commit('SET_ISFLAG', true);\r\n\t\t\t\tthis.service = option.obj.service;\r\n\t\t\t\tthis.serviceId = option.obj.serviceId;\r\n\t\t\t\tthis.characteristic = option.obj.characteristic;\r\n\t\t\t\tthis.characteristicId = option.obj.characteristicId;\r\n\t\t\t\tthis.deviceId = option.obj.deviceId;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t},\r\n\t\tonShareAppMessage(res) {\r\n\t\t\tlet obj = {\r\n\t\t\t\tservice: this.service,\r\n\t\t\t\tserviceId: this.serviceId,\r\n\t\t\t\tcharacteristic: this.characteristic,\r\n\t\t\t\tcharacteristicId: this.characteristicId,\r\n\t\t\t\tdeviceId: this.deviceId\r\n\t\t\t}\r\n\t\t\tif (res.from === 'button') { // 来自页面内分享按钮\r\n\t\t\t\tconsole.log(res.target)\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\ttitle: '分享一下',\r\n\t\t\t\tpath: `/pages/index/index?userId=${this.identity.userId}&obj=${obj}`\r\n\t\t\t}\r\n\t\t},\r\n\r\n\r\n\r\n\t\tmethods: {\r\n\t\t\t        startRecord() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t    url: '/pages/sing/sing'\r\n\t\t\t});\r\n\t\t\t        },\r\n\t\t\t\r\n\t\t\tbindGetUserInfo(e) {\r\n\t\t\t\tlet _this = this\r\n\t\t\t\tuni.getUserProfile({ // 登录授权\r\n\t\t\t\t\tdesc: 'weixin',\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\tthis.userInfo = res.userInfo; // 获取用户信息 \r\n\t\t\t\t\t\tthis.$store.dispatch('SET_USER_INFO', res.userInfo); // 调用vuex存储\r\n\t\t\t\t\t\tuni.login({ // 获取code\r\n\t\t\t\t\t\t\tsuccess(r) {\r\n\t\t\t\t\t\t\t\tconsole.log('获取code成功', r);\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '获取code成功',\r\n\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\t\t\t\turl: `http://192.168.0.64:8888/bluetoothApplets/user/login?code=${r.code}`,\r\n\t\t\t\t\t\t\t\t\tsuccess(x) {\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(x, '进入获取openid');\r\n\t\t\t\t\t\t\t\t\t\tif (x.data.code == 200) {\r\n\t\t\t\t\t\t\t\t\t\t\t_this.identity = x.data.data; // 拿到身份信息 openid\r\n\t\t\t\t\t\t\t\t\t\t\t_this.$store.dispatch('SET_IDENTITY', x.data.data)\r\n\t\t\t\t\t\t\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\t\t\t\t\t\t\turl: \"http://192.168.0.64:8888/bluetoothApplets/user/saveUserInfo\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tmethod: \"post\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\topenId: _this.identity.openid,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tusername: _this.userInfo.nickName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\theadPicture: _this.userInfo.avatarUrl,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsex: _this.userInfo.gender,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsharerId: _this.userId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid:_this.identity.userId\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\tsuccess(y) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(y, '进入获取用户信息');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (y.data.code == 200) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t_this.$store.dispatch('WEBSOCKET_INIT');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"登录成功\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 已分享出去\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (_this.isFlag) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// setInterval(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet param = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"fromId\": _this.identity.userId, // 发送人\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"toId\": _this.userId, // 接收人\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'message': `哈哈哈哈${new Date()}` // 信息\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t_this.$store.commit('WEBSOCKET_SEND', param)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// }, 5000)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (y.data.code == 150) { // 用户已占用\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: `${y.data.msg}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 打回首页\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail(e) {\r\n\t\t\t\t\t\t\t\tconsole.log('获取code失败', e)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: err => {\r\n\t\t\t\t\t\tconsole.log(err, '失败授权')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\r\n\r\n\r\n\t\t\t// 初始化蓝牙模块\r\n\t\t\tonConnect() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tuni.openBluetoothAdapter({\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tthat.startBluetoothDevicesDiscovery(); // 调用查找设备\r\n\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\ttitle: '搜索中'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '请先开启蓝牙',\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 1000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t// 搜索周边蓝牙设备\r\n\t\t\tstartBluetoothDevicesDiscovery() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tuni.startBluetoothDevicesDiscovery({\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tconsole.log(\"查找到的蓝牙设备\", res);\r\n\t\t\t\t\t\tif (res.errCode == 0) { // 等于0为ok\r\n\t\t\t\t\t\t\tthat.getConnect();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t// 获取在蓝牙模块生效期间所有已发现的蓝牙设备。包括已经和本机处于连接状态的设备。\r\n\t\t\tgetConnect() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tvar timer = setInterval(() => {\r\n\t\t\t\t\tuni.getBluetoothDevices({\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tconsole.log('已发现的蓝牙设备', res);\r\n\t\t\t\t\t\t\tfor (var i = 0; i < res.devices.length; i++) {\r\n\t\t\t\t\t\t\t\tif (res.devices[i].name.indexOf(\"sakuraneko\") != -1) { // 包含\r\n\t\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '连接中'\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tclearInterval(timer); // 连接成功 清空定时器\r\n\t\t\t\t\t\t\t\t\tthat.deviceId = res.devices[i].deviceId;\r\n\t\t\t\t\t\t\t\t\tconsole.log('设备号', that.deviceId);\r\n\t\t\t\t\t\t\t\t\tconsole.log('开始建立连接');\r\n\r\n\t\t\t\t\t\t\t\t\t// 连接低功耗蓝牙设备\r\n\t\t\t\t\t\t\t\t\tuni.createBLEConnection({\r\n\t\t\t\t\t\t\t\t\t\tdeviceId: that.deviceId,\r\n\t\t\t\t\t\t\t\t\t\ttimeout: 10000,\r\n\t\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('连接低功耗蓝牙', res);\r\n\t\t\t\t\t\t\t\t\t\t\tif (res.errCode == 0) { // 为0正常\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('连接成功');\r\n\t\t\t\t\t\t\t\t\t\t\t\tthat.isConnected = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 停止搜寻附件蓝牙设备\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.stopBluetoothDevicesDiscovery();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: '不能正常对蓝牙设备进行连接',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\t\t\t\tif (res.errCode == 10012) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: '连接超时',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tbreak; // 连接成功 退出循环\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 3000);\r\n\t\t\t\t// 如果循环过长 未找到想要的设备 超过12秒则超时\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (!that.isConnected) { // 未连接\r\n\t\t\t\t\t\tclearInterval(timer); // 清空定时器\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\tcontent: '搜索蓝牙超时',\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 12000);\r\n\t\t\t},\r\n\t\t\t// 进制转化\r\n\t\t\tab2hex(buffer) {\r\n\t\t\t\tvar hexArr = Array.prototype.map.call(new Uint8Array(buffer), function(bit) {\r\n\t\t\t\t\treturn ('00' + bit.toString(16)).slice(-2)\r\n\t\t\t\t})\r\n\t\t\t\treturn hexArr.join('');\r\n\t\t\t},\r\n\r\n\t\t\t// 发送指令\r\n\t\t\tonSendCommand(msg) {\r\n\t\t\t\tconsole.log(msg, '获取到的指令');\r\n\t\t\t\tvar message;\r\n\r\n\t\t\t\t\tmessage = 'A1 08 01 00 00 00 64 1E 00 32 61 55'\r\n\t\t\t\t\r\n\t\t\t\tlet that = this;\r\n\t\t\t\t// 一个马达震动指令\r\n\t\t\t\tlet data = message.split(' ');\r\n\t\t\t\tvar buf = new ArrayBuffer(data.length);\r\n\t\t\t\tlet dataView = new DataView(buf);\r\n\t\t\t\tfor (let i = 0; i < data.length; i++) {\r\n\t\t\t\t\tdataView.setUint8(i, '0x' + data[i]);\r\n\t\t\t\t}\r\n\t\t\t\t// 向低功耗蓝牙设备特征值中写入二进制数据\r\n\t\t\t\tuni.writeBLECharacteristicValue({\r\n\t\t\t\t\tdeviceId: that.deviceId, // 设备id\r\n\t\t\t\t\tserviceId: that.serviceId,\r\n\t\t\t\t\tcharacteristicId: that.characteristicId,\r\n\t\t\t\t\tvalue: buf,\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tconsole.log(res, '发送指令成功');\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"发送成功\",\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\tconsole.log('发送指令失败', res);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t// 获取设备信息\r\n\t\t\tonGetuuid() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tif (that.isConnected) { // 连接成功\r\n\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\ttitle: '获取serviceId'\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.log('开始获取设备信息');\r\n\r\n\t\t\t\t\t// 获取蓝牙设备所有服务(service)\r\n\t\t\t\t\tuni.getBLEDeviceServices({\r\n\t\t\t\t\t\tdeviceId: that.deviceId,\r\n\t\t\t\t\t\tsuccess(getServicesRes) {\r\n\t\t\t\t\t\t\tconsole.log('设备信息', getServicesRes);\r\n\t\t\t\t\t\t\tthat.services = getServicesRes.services;\r\n\t\t\t\t\t\t\tthat.serviceId = getServicesRes.services[0].uuid;\r\n\t\t\t\t\t\t\tconsole.log(that.serviceId);\r\n\t\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\t\ttitle: '获取蓝牙特征值的uuid'\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t//获取蓝牙设备某个服务中所有特征值(characteristic)\r\n\t\t\t\t\t\t\tuni.getBLEDeviceCharacteristics({\r\n\t\t\t\t\t\t\t\tdeviceId: that.deviceId,\r\n\t\t\t\t\t\t\t\tserviceId: that.serviceId,\r\n\t\t\t\t\t\t\t\tsuccess(getCharactersRes) {\r\n\t\t\t\t\t\t\t\t\tconsole.log('获取所有特征值', getCharactersRes);\r\n\t\t\t\t\t\t\t\t\tthat.characteristic = getCharactersRes.characteristics;\r\n\t\t\t\t\t\t\t\t\tthat.characteristicId = getCharactersRes.characteristics[1].uuid;\r\n\r\n\t\t\t\t\t\t\t\t\t// 启用低功耗蓝牙设备特征值变化时的 notify 功能，订阅特征值\r\n\t\t\t\t\t\t\t\t\tconsole.log(that.deviceId, that.serviceId, that.characteristicId)\r\n\t\t\t\t\t\t\t\t\tuni.notifyBLECharacteristicValueChange({\r\n\t\t\t\t\t\t\t\t\t\tstate: true, // 启用notify\r\n\t\t\t\t\t\t\t\t\t\tdeviceId: that.deviceId,\r\n\t\t\t\t\t\t\t\t\t\tserviceId: that.serviceId,\r\n\t\t\t\t\t\t\t\t\t\tcharacteristicId: that.characteristicId,\r\n\t\t\t\t\t\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('开始监听特征值');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t// 监听低功耗蓝牙设备的特征值变化事件\r\n\t\t\t\t\t\t\t\t\t\t\tuni.onBLECharacteristicValueChange(function(onNotityChangeRes) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('监听到特征值更新', onNotityChangeRes);\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet characteristicValue = that.ab2hex(onNotityChangeRes.value);\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"characteristicValue-16进制\", characteristicValue);\r\n\t\t\t\t\t\t\t\t\t\t\t\t// 设备给你返回的\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '监听到特征值更新',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: `更新后特征值${characteristicValue}`\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.warn(\"监听特征值失败\");\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\t\t\tconsole.warn(\"获取特征值信息失败\", err);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcomplete(err) {\r\n\t\t\t\t\t\t\t\t\tconsole.log('获取服务信息完成', err);\r\n\t\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\tconsole.warn(\"获取服务信息失败\", err);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcomplete(err) {\r\n\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请先连接蓝牙',\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 关闭连接\r\n\t\t\tonCloseConnect() {\r\n\t\t\t\tthis.isConnected = false;\r\n\t\t\t\tuni.closeBLEConnection({\r\n\t\t\t\t\tdeviceId: this.deviceId,\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tconsole.log('断开连接');\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '成功断开连接'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t// B给A发送指令\r\n\t\t\tonSendB() {\r\n\t\t\t\tlet param = {\r\n\t\t\t\t\t\"fromId\": this.identity.userId, // 发送人\r\n\t\t\t\t\t\"toId\": this.userId, // 接收人\r\n\t\t\t\t\t'message': `A1 08 01 00 00 00 64 1E 00 32 61 55` // 信息\r\n\t\t\t\t}\r\n\t\t\t\tthis.$store.commit('WEBSOCKET_SEND', param)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.logo {\r\n\t\theight: 200rpx;\r\n\t\twidth: 200rpx;\r\n\t\tmargin-top: 200rpx;\r\n\t\tmargin-left: auto;\r\n\t\tmargin-right: auto;\r\n\t\tmargin-bottom: 50rpx;\r\n\t}\r\n\r\n\t.text-area {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.title {\r\n\t\tfont-size: 36rpx;\r\n\t\tcolor: #8f8f94;\r\n\t}\r\n</style>\n","import mod from \"-!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\softWare\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1637911610571\n      var cssReload = require(\"D:/softWare/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}